package org.apache.spark.sql.execution.vectorized

import org.apache.spark.sql.SparkSession

/**
  * Created by gcz on 17-7-13.
  */
object TestCMCC {
  def main(args: Array[String]) = {

    val spark = SparkSession.builder().master("local").getOrCreate()

    spark.conf.set("spark.sql.codegen.wholeStage", "false")

    spark.read.parquet("file:///home/gcz/fpga/hubei-cmcc_after").registerTempTable("table")
    val res = spark.sql("select MBUSER_ID, (substr(ACC_NBR,1,15)) ACC_NBR, (NBILLING_TID) NBILLING_TID, (OBILLING_TID) OBILLING_TID, (BRAND_ID) BRAND_ID, (TM_TID) TM_TID, (AREA_ID) AREA_ID, (VPMN_ID) VPMN_ID, (ACCT_ID) ACCT_ID, (CHANNEL_CODE) CHANNEL_CODE, (SEX_ID) SEX_ID, (STATE_TID) STATE_TID, (OSTATE_TID) OSTATE_TID, (BIRTH_DATE) BIRTH_DATE, (SUM_CHARGE) SUM_CHARGE, (SUM_DURA) SUM_DURA, (SUM_FLOW) SUM_FLOW, (SUM_INFO_LEN) SUM_INFO_LEN, (SUM_TIMES) SUM_TIMES, (SUM_BILL_TIMES) SUM_BILL_TIMES, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') then SUM_TIMES else 0.0 end) SUM_CALL_TIMES, (CHARGE1) CHARGE1, (CHARGE2) CHARGE2, (CHARGE3) CHARGE3, (CHARGE4) CHARGE4, (CHARGE1_S) CHARGE1_S, (CHARGE2_S) CHARGE2_S, (CHARGE3_S) CHARGE3_S, (CHARGE4_S) CHARGE4_S, (SUM_BILL_DURA) SUM_BILL_DURA, (DURA1) DURA1, (DURA2) DURA2, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') then DURA1 else 0.0 end ) SUM_CALL_DURA, (FLOWUP1) FLOWUP1, (FLOWUP2) FLOWUP2, (FLOWDN1) FLOWDN1, (FLOWDN2) FLOWDN2, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) IN('O') then SUM_TIMES else 0.0 end) ZJTH_TIMES, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) IN('O') then DURA1 else 0.0 end) ZJTH_DURA1, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) IN('O') then SUM_CHARGE else 0.0 end) ZJTH_CHARGE, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) IN('T') then SUM_TIMES else 0.0 end) BJTH_TIMES, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) IN('T') then DURA1 else 0.0 end) BJTH_DURA1, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) IN('T') then SUM_CHARGE else 0.0 end) BJTH_CHARGE, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) IN('F') then SUM_TIMES else 0.0 end) HZ_TIMES, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) IN('F') then dura1 else 0.0 end) HZ_DURA1, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) IN('F') then SUM_CHARGE else 0.0 end) HZ_CHARGE, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) NOT IN('T') AND substr(OPER_TID,4,1) in('0','1','2','3','4') then SUM_TIMES else 0.0 end) bd_in_call_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) NOT IN('T') AND substr(OPER_TID,4,1) in('0','1','2','3','4') then DURA1 else 0.0 end) bd_in_call_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) IN('T') AND substr(OPER_TID,4,1) in ('0','1','2','3','4') then SUM_TIMES else 0.0 end) bd_out_call_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) IN('T') AND substr(OPER_TID,4,1) in ('0','1','2','3','4') then dura1 else 0.0 end) bd_out_call_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) NOT IN('T') AND substr(OPER_TID,4,1) in('5') then SUM_TIMES else 0.0 end) sn_in_call_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) NOT IN('T') AND substr(OPER_TID,4,1) in('5') then dura1 else 0.0 end) sn_in_call_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) IN('T') AND substr(OPER_TID,4,1) in ('5') then SUM_TIMES else 0.0 end) sn_out_call_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) IN('T') AND substr(OPER_TID,4,1) in ('5') then dura1 else 0.0 end) sn_out_call_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) NOT IN('T') AND substr(OPER_TID,4,1) in('6') then SUM_TIMES else 0.0 end) sj_in_call_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) NOT IN('T') AND substr(OPER_TID,4,1) in('6') then dura1 else 0.0 end) sj_in_call_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) IN('T') AND substr(OPER_TID,4,1) in ('6') then SUM_TIMES else 0.0 end) sj_out_call_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) IN('T') AND substr(OPER_TID,4,1) in ('6') then dura1 else 0.0 end) sj_out_call_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) NOT IN('T') AND substr(OPER_TID,4,1) in('7','8','9','A','B','C') then SUM_TIMES else 0.0 end) gj_in_call_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) NOT IN('T') AND substr(OPER_TID,4,1) in('7','8','9','A','B','C') then dura1 else 0.0 end) gj_in_call_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) IN('T') AND substr(OPER_TID,4,1) in ('7','8','9','A','B','C') then SUM_TIMES else 0.0 end) gj_out_call_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1) IN('T') AND substr(OPER_TID,4,1) in ('7','8','9','A','B','C') then dura1 else 0.0 end) gj_out_call_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,6,1)='1' then SUM_TIMES else 0.0 end) innet_call_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,6,1)='1' then dura1 else 0.0 end) innet_call_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,6,1)<>'1' then SUM_TIMES else 0.0 end) outnet_call_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,6,1)<>'1' then dura1 else 0.0 end) outnet_call_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,13,2) ='ug' then SUM_TIMES else 0.0 end) WJ_unigsm_call_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,13,2)='uc' then SUM_TIMES else 0.0 end) WJ_unicdma_call_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,13,2)='ph' then SUM_TIMES else 0.0 end) WJ_phs_call_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,13,2)='ug' then dura1 else 0.0 end) WJ_unigsm_call_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,13,2)='uc' then dura1 else 0.0 end) WJ_unicdma_call_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,13,2)='ph' then dura1 else 0.0 end) WJ_phs_call_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('7') then SUM_TIMES else 0.0 end) inent_call_times, (case when SUBSTR(OPER_TID,1,1) IN ('1') then SUM_TIMES else 0.0 end) outent_call_times, (case when SUBSTR(OPER_TID,1,1) IN ('7') then dura1 else 0.0 end) inent_call_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1') then dura1 else 0.0 end) outent_call_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1)='F' and substr(OPER_TID,13,2)='ug' then SUM_TIMES else 0.0 end) callfw_unigsm_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1)='F' and substr(OPER_TID,13,2)='ug' then dura1 else 0.0 end) callfw_unigsm_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1)='F' and substr(OPER_TID,13,2)='uc' then SUM_TIMES else 0.0 end) callfw_unicdma_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1)='F' and substr(OPER_TID,13,2)='uc' then dura1 else 0.0 end) callfw_unicdma_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1)='F' and substr(OPER_TID,13,2)='ph' then SUM_TIMES else 0.0 end) callfw_phs_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1)='F' and substr(OPER_TID,13,2)='ph' then dura1 else 0.0 end) callfw_phs_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1)='F' and substr(OPER_TID,13,2) in('dx','wt','tt') then SUM_TIMES else 0.0 end) callfw_guhua_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,2,1)='F' and substr(OPER_TID,13,2) in('dx','wt','tt') then dura1 else 0.0 end) callfw_guhua_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and charge3_s>0 then SUM_TIMES else 0.0 end) toll_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') then dura2 else 0.0 end ) toll_duration_s, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,9,1) not in ('0','*') then SUM_TIMES else 0.0 end) ip_duration_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,9,1) not in ('0','*') then dura1 else 0.0 end ) ip_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,3,1) in ('0','1','3') then SUM_TIMES else 0.0 end) not_roam_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,3,1) in ('0','1','3') then dura1 else 0.0 end ) not_roam_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,3,1) in ('4','6','8','9','A','B','C') then SUM_TIMES else 0.0 end) roam_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,3,1) in ('4','6','8','9','A','B','C') then dura1 else 0.0 end ) roam_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,3,1) in ('4','6','8','9','A','B','C') and substr(OPER_TID,2,1) NOT IN ('T') then dura1 else 0.0 end ) roam_zj_dura, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,3,1) in ('4','6','8','9','A','B','C') and substr(OPER_TID,2,1) IN ('T') then dura1 else 0.0 end ) roam_bj_dura, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,3,1) in ('4') then SUM_TIMES else 0.0 end) sn_roam_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,3,1) in ('4') then dura1 else 0.0 end ) sn_roam_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,3,1) in ('6') then SUM_TIMES else 0.0 end) sj_roam_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,3,1) in ('6') then dura1 else 0.0 end ) sj_roam_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,3,1) in ('8','9','A','B','C') then SUM_TIMES else 0.0 end) gj_roam_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,3,1) in ('8','9','A','B','C') then dura1 else 0.0 end ) gj_roam_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,13,2) in ('51','52','74') then SUM_TIMES else 0.0 end) call_1860_1861_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,13,2) in ('51','52','74') then dura1 else 0.0 end) call_1860_1861_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,13,2) in ('42') then SUM_TIMES else 0.0 end) call_13800_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,13,2) in ('42') then dura1 else 0.0 end) call_13800_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,13,2) in ('16','17','19','20','51','52','42','21','74') then SUM_TIMES else 0.0 end) freefunc_call_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,13,2) in ('16','17','19','20','51','52','42','21','74') then dura1 else 0.0 end) freefunc_call_duration, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,13,2) in ('14') then SUM_TIMES else 0.0 end) call_10000_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,13,2) in ('14') then dura1 else 0.0 end) call_10000_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,13,2) in ('15') then SUM_TIMES else 0.0 end) call_10010_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,13,2) in ('15') then dura1 else 0.0 end) call_10010_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,13,2) in ('23') then SUM_TIMES else 0.0 end) call_12580_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,13,2) in ('23') then dura1 else 0.0 end) call_12580_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,13,2) in ('73') then SUM_TIMES else 0.0 end) call_114_times, (case when SUBSTR(OPER_TID,1,1) IN ('1','7') and substr(OPER_TID,13,2) in ('73') then dura1 else 0.0 end) call_114_duration_m, (case when SUBSTR(OPER_TID,1,1) IN ('2') and substr(OPER_TID,13,1) not in ('3','F','G') then SUM_TIMES when SUBSTR(OPER_TID,1,1) IN ('4') and substr(OPER_TID,7,2) in ('69','70') then SUM_TIMES else 0.0 end) SMS_TIMES, (case when SUBSTR(OPER_TID,1,1) IN ('2') and substr(OPER_TID,13,1) not in ('3','F','G') then SUM_CHARGE when SUBSTR(OPER_TID,1,1) IN ('4') and substr(OPER_TID,7,2) in ('69','70') then SUM_CHARGE else 0.0 end) SMS_CHARGE, (case when SUBSTR(OPER_TID,1,1) IN ('2') and substr(OPER_TID,13,1) in ('5','E') then SUM_TIMES when SUBSTR(OPER_TID,1,1) IN ('4') and substr(OPER_TID,7,2) in ('69','70') then SUM_TIMES else 0.0 end) IN_SMS_TIMES, (case when SUBSTR(OPER_TID,1,1) IN ('2') and substr(OPER_TID,13,1) in ('5','E') then SUM_CHARGE when SUBSTR(OPER_TID,1,1) IN ('4') and substr(OPER_TID,7,2) in ('69','70') then SUM_CHARGE else 0.0 end) IN_SMS_CHARGE, (case when SUBSTR(OPER_TID,1,1) IN ('2') and substr(OPER_TID,13,1) in ('0','6') and substr(OPER_TID,6,1) in ('2','3','4') then SUM_TIMES else 0.0 end) OUT_SMS_TIMES, (case when SUBSTR(OPER_TID,1,1) IN ('2') and substr(OPER_TID,13,1) in ('0','6') and substr(OPER_TID,6,1) in ('2','3','4') then SUM_CHARGE else 0.0 end) OUT_SMS_CHARGE, (case when SUBSTR(OPER_TID,1,1) IN ('2') and substr(OPER_TID,13,1) in ('0','6') and substr(OPER_TID,6,1) in ('9','G') and substr(OPER_TID,2,1)='O' then SUM_TIMES else 0.0 end) INTL_SMS_TIMES, (case when SUBSTR(OPER_TID,1,1) IN ('2') and substr(OPER_TID,13,1) in ('0','6') and substr(OPER_TID,6,1) in ('9','G') then SUM_CHARGE else 0.0 end) INTL_SMS_CHARGE, (case when SUBSTR(OPER_TID,1,1) IN ('3') then SUM_TIMES else 0.0 end) GPRS_TIMES, (case when SUBSTR(OPER_TID,1,1) IN ('3') then sum_info_len else 0.0 end) GPRS_DURA, (case when SUBSTR(OPER_TID,1,1) IN ('3') then dura1 else 0.0 end) GPRS_DURA1, (case when SUBSTR(OPER_TID,1,1) IN ('3') then dura2 else 0.0 end) GPRS_DURA2, (case when SUBSTR(OPER_TID,1,1) IN ('3') then SUM_CHARGE else 0.0 end) GPRS_CHARGE, (case when SUBSTR(OPER_TID,1,1) IN ('4') and substr(OPER_TID,7,2) not in ('69','70') then SUM_TIMES  when SUBSTR(OPER_TID,1,1) IN ('2') and substr(OPER_TID,13,1) IN ('3','F','G') then SUM_TIMES else 0.0 end) MON_TIMES, (case when SUBSTR(OPER_TID,1,1) IN ('4') and substr(OPER_TID,7,2) not in ('69','70') then SUM_CHARGE when SUBSTR(OPER_TID,1,1) IN ('2') and substr(OPER_TID,13,1) IN ('3','F','G') then SUM_CHARGE else 0.0 end) MON_CHARGE, (case when SUBSTR(OPER_TID,1,1) IN ('2') and substr(OPER_TID,13,1) IN ('3','F','G') then SUM_TIMES else 0.0 end) UP_MON_TIMES, (case when SUBSTR(OPER_TID,1,1) IN ('2') and substr(OPER_TID,13,1) IN ('3','F','G') then SUM_CHARGE else 0.0 end) UP_MON_CHARGE, (case when SUBSTR(OPER_TID,1,1) IN ('4') and substr(OPER_TID,4,1) IN('1','2') and substr(OPER_TID,7,2) not in ('69','70') then SUM_TIMES else 0.0 end) DOWN_MON_TIMES, (case when SUBSTR(OPER_TID,1,1) IN ('4') and substr(OPER_TID,4,1) IN('1','2') and substr(OPER_TID,7,2) not in ('69','70') then SUM_CHARGE else 0.0 end) DOWN_MON_CHARGE, (case when SUBSTR(OPER_TID,1,1) IN ('5') then SUM_TIMES else 0.0 end) MMS_TIMES, (case when SUBSTR(OPER_TID,1,1) IN ('5') then SUM_CHARGE else 0.0 end) MMS_CHARGE, (case when SUBSTR(OPER_TID,1,1) IN ('5') and substr(OPER_TID,11,2)<>'2Y' and substr(OPER_TID,6,1) in ('0') and substr(OPER_TID,2,1) in('A','9','3','4') and SUM_CHARGE>0 then sum_bill_times else 0.0 end) IN_MMS_TIMES, (case when SUBSTR(OPER_TID,1,1) IN ('5') and substr(OPER_TID,11,2)<>'2Y' and substr(OPER_TID,6,1) in ('0') and substr(OPER_TID,2,1) in('A','9','3','4') then SUM_CHARGE else 0.0 end) IN_MMS_CHARGE, (case when SUBSTR(OPER_TID,1,1) IN ('5') and substr(OPER_TID,11,2)='2Y' and substr(OPER_TID,6,1) in ('0') and substr(OPER_TID,2,1) in('A','9','3','4') and SUM_CHARGE>0 then sum_bill_times else 0.0 end) OUT_MMS_TIMES, (case when SUBSTR(OPER_TID,1,1) IN ('5') and substr(OPER_TID,11,2)='2Y' and substr(OPER_TID,6,1) in ('0') and substr(OPER_TID,2,1) in('A','9','3','4') then SUM_CHARGE else 0.0 end) OUT_MMS_CHARGE, (case when SUBSTR(OPER_TID,1,1) IN ('5') and substr(OPER_TID,11,2)='20' and substr(OPER_TID,6,1) in ('0') and substr(OPER_TID,2,1) in('A','9','3','4') and SUM_CHARGE>0 then sum_bill_times else 0.0 end) INTL_MMS_TIMES, (case when SUBSTR(OPER_TID,1,1) IN ('5') and substr(OPER_TID,11,2)='20' and substr(OPER_TID,6,1) in ('0') and substr(OPER_TID,2,1) in('A','9','3','4') and SUM_CHARGE>0 then SUM_CHARGE else 0.0 end) INTL_MMS_CHARGE, (case when SUBSTR(OPER_TID,1,1) IN ('5') and (( substr(OPER_TID,6,1) ='1' and substr(OPER_TID,2,1) in('8','9')) or(substr(OPER_TID,6,1) ='2' and substr(OPER_TID,2,1) in('A'))) and SUM_CHARGE>0 then sum_bill_times else 0.0 end) mail_mms_times, (case when SUBSTR(OPER_TID,1,1) IN ('5') and (( substr(OPER_TID,6,1) ='1' and substr(OPER_TID,2,1) in('8','9')) or(substr(OPER_TID,6,1) ='2' and substr(OPER_TID,2,1) in('A'))) then SUM_CHARGE else 0.0 end) mail_mms_charge, (case when SUBSTR(OPER_TID,1,1) IN ('5') and ((substr(OPER_TID,6,1) ='3' and substr(OPER_TID,2,1) in('9','B')) or(substr(OPER_TID,6,1)='4' and substr(OPER_TID,2,1)='A')) and SUM_CHARGE>0 then sum_bill_times else 0.0 end) mon_mms_times, (case when SUBSTR(OPER_TID,1,1) IN ('5') and ((substr(OPER_TID,6,1) ='3' and substr(OPER_TID,2,1) in('9','B')) or(substr(OPER_TID,6,1)='4' and substr(OPER_TID,2,1)='A')) then SUM_CHARGE else 0.0 end) mon_mms_charge, (case when SUBSTR(OPER_TID,1,1) IN ('4') and substr(OPER_TID,6,1) IN('H') then SUM_TIMES else 0.0 end) JAVA_TIMES, (case when SUBSTR(OPER_TID,1,1) IN ('4') and substr(OPER_TID,6,1) IN('H') then SUM_CHARGE else 0.0 end) JAVA_CHARGE, (case when SUBSTR(OPER_TID,1,1) IN ('3') and substr(OPER_TID,7,1)='0' then floor((sum_info_len)/1024) else 0 end) wap_flows, (case when SUBSTR(OPER_TID,1,1) IN ('6') then dura1 else 0.0 end) wlan_flows, (case when SUBSTR(OPER_TID,1,1) IN ('6') then SUM_CHARGE else 0.0 end) wlan_fee, (case when SUBSTR(OPER_TID,1,1) IN ('1') and SUBSTR(OPER_TID,11,2)='1a' and SUBSTR(OPER_TID,13,2)='25' then SUM_TIMES else 0.0 end) YDSN_TIMES, (case when SUBSTR(OPER_TID,1,1) IN ('1') and SUBSTR(OPER_TID,11,2)='1a' and SUBSTR(OPER_TID,13,2)='25' then charge1+charge2 else 0.0 end) YDSN_COMM_CHARGE, (case when SUBSTR(OPER_TID,1,1) IN ('1') and SUBSTR(OPER_TID,11,2)='1a' and SUBSTR(OPER_TID,11,2)='25' then charge3 else 0.0 end) YDSN_INFO_CHARGE, (case when SUBSTR(OPER_TID,1,1) IN ('1') and SUBSTR(OPER_TID,11,2)='1a' and SUBSTR(OPER_TID,11,2)='25' then dura1 else 0.0 end) YDSN_DURA1, (case when SUBSTR(OPER_TID,1,1) IN ('1') and SUBSTR(OPER_TID,13,2) in ('29','30','31','38','35','32','40','33','28','36','37') then SUM_TIMES else 0.0 end) YYZZ_TIMES, (case when substr(OPER_TID,1,1) IN ('1') and substr(OPER_TID,2,1) IN ('O') and substr(OPER_TID,13,2) in ('29','30','31','38','35','32','40','33','28','36','37') then charge1+charge2+charge3 else 0.0 end) YYZZ_COMM_CHARGE, (case when SUBSTR(OPER_TID,1,1) IN ('1') and SUBSTR(OPER_TID,13,2) in ('35','32','40','33','28','36','37') then charge3 else 0.0 end) YYZZ_INFO_CHARGE, (case when SUBSTR(OPER_TID,1,1) IN ('1') and SUBSTR(OPER_TID,13,2) in ('29','30','31','38','35','32','40','33','28','36','37') then dura1 else 0.0 end) YYZZ_DURA1, (case when SUBSTR(OPER_TID,1,1) IN ('1') and SUBSTR(OPER_TID,13,2) in ('29','30','31','38') then SUM_TIMES else 0.0 end) L_YYZZ_TIMES, (case when substr(OPER_TID,1,1) IN ('1') and substr(OPER_TID,2,1) IN ('O') and substr(OPER_TID,13,2) in ('29','30','31','38') then charge1+charge2+charge3 else 0.0 end) L_YYZZ_COMM_CHARGE, (0) L_YYZZ_INFO_CHARGE, (case when SUBSTR(OPER_TID,1,1) IN ('1') and SUBSTR(OPER_TID,13,2) in ('29','30','31','38') then dura1 else 0.0 end) L_YYZZ_DURA1, (case when SUBSTR(OPER_TID,1,1) IN ('1') and SUBSTR(OPER_TID,13,2) in ('35','32','40','33','28','36','37') then SUM_TIMES else 0.0 end) Q_YYZZ_TIMES, (case when SUBSTR(OPER_TID,1,1) IN ('1') and substr(OPER_TID,2,1) IN('O') and SUBSTR(OPER_TID,13,2) in ('35','32','40','33','28','36','37') then charge1+charge2 when SUBSTR(OPER_TID,1,1) IN ('1') and substr(OPER_TID,2,1) IN('T') and SUBSTR(OPER_TID,13,2) in ('35','32','40','33','28','36','37') then charge1+charge2+charge3 else 0.0 end) Q_YYZZ_COMM_CHARGE, (case when SUBSTR(OPER_TID,1,1) IN ('1') and SUBSTR(OPER_TID,13,2) in ('35','32','40','33','28','36','37') then charge3 else 0.0 end) Q_YYZZ_INFO_CHARGE, (case when SUBSTR(OPER_TID,1,1) IN ('1') and SUBSTR(OPER_TID,13,2) in ('35','32','40','33','28','36','37')  then dura1 else 0.0 end) Q_YYZZ_DURA1, (case when SUBSTR(OPER_TID,1,1) IN ('4') and SUBSTR(OPER_TID,6,1) in ('E','F') then SUM_BILL_TIMES else 0.0 end) cl_download_times, (case when SUBSTR(OPER_TID,1,1) IN ('4') and SUBSTR(OPER_TID,6,1) in ('E') then SUM_BILL_TIMES else 0.0 end) time_download_times, (case when SUBSTR(OPER_TID,1,1) IN ('4') and SUBSTR(OPER_TID,6,1) in ('F') then SUM_BILL_TIMES else 0.0 end) rent_download_times from table")

    res.explain(true)
    res.show

  }
}
